{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/truongdo1z/marketplace/components/Wallet-connect.tsx"],"sourcesContent":["\"use client\"\n\nimport { ConnectButton } from \"@iota/dapp-kit\"\n\nexport function WalletConnect() {\n  return (\n    <div style={{ padding: \"1rem\", display: \"flex\", justifyContent: \"flex-end\" }}>\n      <ConnectButton />\n    </div>\n  )\n}\n\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAIO,SAAS;IACd,qBACE,6LAAC;QAAI,OAAO;YAAE,SAAS;YAAQ,SAAS;YAAQ,gBAAgB;QAAW;kBACzE,cAAA,6LAAC,iLAAa;;;;;;;;;;AAGpB;KANgB"}},
    {"offset": {"line": 41, "column": 0}, "map": {"version":3,"sources":["file:///home/truongdo1z/marketplace/components/AddItemForm.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState } from \"react\";\r\n\r\ninterface AddItemFormProps {\r\n  onAddItem: (name: string, price: string) => Promise<void>;\r\n  isLoading?: boolean;\r\n}\r\n\r\nexport default function AddItemForm({ onAddItem, isLoading = false }: AddItemFormProps) {\r\n  const [name, setName] = useState(\"\");\r\n  const [price, setPrice] = useState(\"\");\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (!name.trim() || !price.trim()) return;\r\n\r\n    try {\r\n      await onAddItem(name.trim(), price.trim());\r\n      setName(\"\");\r\n      setPrice(\"\");\r\n    } catch (error) {\r\n      console.error(\"Error adding item:\", error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-white p-6 rounded-lg shadow-md mb-6\">\r\n      <h2 className=\"text-xl font-semibold mb-4\">Th√™m s·∫£n ph·∫©m m·ªõi</h2>\r\n      \r\n      {/* Price unit explanation */}\r\n      <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4\">\r\n        <div className=\"flex items-start\">\r\n          <svg className=\"w-5 h-5 text-blue-400 mt-0.5 mr-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n            <path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z\" clipRule=\"evenodd\" />\r\n          </svg>\r\n          <div>\r\n            <h4 className=\"text-blue-800 font-medium text-sm\">ƒê∆°n v·ªã gi√°</h4>\r\n            <p className=\"text-blue-700 text-xs mt-1\">\r\n              Nh·∫≠p gi√° theo ƒë∆°n v·ªã IOTA th·∫≠t. VD: 0.001 IOTA s·∫Ω tr·ª´ ch√≠nh x√°c 0.001 IOTA t·ª´ v√≠ ng∆∞·ªùi mua.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n        <div>\r\n          <label htmlFor=\"name\" className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n            T√™n s·∫£n ph·∫©m\r\n          </label>\r\n          <input\r\n            type=\"text\"\r\n            id=\"name\"\r\n            value={name}\r\n            onChange={(e) => setName(e.target.value)}\r\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-800\"\r\n            placeholder=\"Nh·∫≠p t√™n s·∫£n ph·∫©m...\"\r\n            disabled={isLoading}\r\n          />\r\n        </div>\r\n        <div>\r\n          <label htmlFor=\"price\" className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n            Gi√° (IOTA) - VD: 0.001\r\n          </label>\r\n          <input\r\n            type=\"number\"\r\n            id=\"price\"\r\n            value={price}\r\n            onChange={(e) => setPrice(e.target.value)}\r\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-800\"\r\n            placeholder=\"0.001\"\r\n            min=\"0\"\r\n            step=\"0.000001\"\r\n            disabled={isLoading}\r\n          />\r\n        </div>\r\n        <button\r\n          type=\"submit\"\r\n          disabled={isLoading || !name.trim() || !price.trim()}\r\n          className=\"w-full bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-600 disabled:bg-gray-400 disabled:cursor-not-allowed\"\r\n        >\r\n          {isLoading ? \"ƒêang th√™m...\" : \"Th√™m s·∫£n ph·∫©m\"}\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":";;;;;AAEA;;;AAFA;;AASe,SAAS,YAAY,EAAE,SAAS,EAAE,YAAY,KAAK,EAAoB;;IACpF,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAC;IACjC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IAEnC,MAAM,eAAe,OAAO;QAC1B,EAAE,cAAc;QAChB,IAAI,CAAC,KAAK,IAAI,MAAM,CAAC,MAAM,IAAI,IAAI;QAEnC,IAAI;YACF,MAAM,UAAU,KAAK,IAAI,IAAI,MAAM,IAAI;YACvC,QAAQ;YACR,SAAS;QACX,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,sBAAsB;QACtC;IACF;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAG,WAAU;0BAA6B;;;;;;0BAG3C,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAI,WAAU;4BAAoC,MAAK;4BAAe,SAAQ;sCAC7E,cAAA,6LAAC;gCAAK,UAAS;gCAAU,GAAE;gCAAmI,UAAS;;;;;;;;;;;sCAEzK,6LAAC;;8CACC,6LAAC;oCAAG,WAAU;8CAAoC;;;;;;8CAClD,6LAAC;oCAAE,WAAU;8CAA6B;;;;;;;;;;;;;;;;;;;;;;;0BAOhD,6LAAC;gBAAK,UAAU;gBAAc,WAAU;;kCACtC,6LAAC;;0CACC,6LAAC;gCAAM,SAAQ;gCAAO,WAAU;0CAA+C;;;;;;0CAG/E,6LAAC;gCACC,MAAK;gCACL,IAAG;gCACH,OAAO;gCACP,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;gCACvC,WAAU;gCACV,aAAY;gCACZ,UAAU;;;;;;;;;;;;kCAGd,6LAAC;;0CACC,6LAAC;gCAAM,SAAQ;gCAAQ,WAAU;0CAA+C;;;;;;0CAGhF,6LAAC;gCACC,MAAK;gCACL,IAAG;gCACH,OAAO;gCACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;gCACxC,WAAU;gCACV,aAAY;gCACZ,KAAI;gCACJ,MAAK;gCACL,UAAU;;;;;;;;;;;;kCAGd,6LAAC;wBACC,MAAK;wBACL,UAAU,aAAa,CAAC,KAAK,IAAI,MAAM,CAAC,MAAM,IAAI;wBAClD,WAAU;kCAET,YAAY,iBAAiB;;;;;;;;;;;;;;;;;;AAKxC;GA7EwB;KAAA"}},
    {"offset": {"line": 235, "column": 0}, "map": {"version":3,"sources":["file:///home/truongdo1z/marketplace/components/ItemList.tsx"],"sourcesContent":["\"use client\";\r\n\r\ninterface Item {\r\n  id: string;\r\n  name: string;\r\n  price: number;\r\n  seller: string;\r\n  sold: boolean;\r\n}\r\n\r\ninterface ItemListProps {\r\n  items: Item[];\r\n  onBuyItem: (itemIndex: number, price: number) => Promise<void>;\r\n  currentUser?: string;\r\n  isLoading?: boolean;\r\n}\r\n\r\nexport default function ItemList({ items, onBuyItem, currentUser, isLoading = false }: ItemListProps) {\r\n  const availableItems = items.filter(item => !item.sold);\r\n\r\n  const handleBuyClick = async (itemIndex: number, price: number) => {\r\n    console.log(`ItemList: handleBuyClick called with index=${itemIndex}, price=${price}`);\r\n    try {\r\n      await onBuyItem(itemIndex, price);\r\n    } catch (error) {\r\n      console.error(\"Error buying item:\", error);\r\n    }\r\n  };\r\n\r\n  if (availableItems.length === 0) {\r\n    return (\r\n      <div className=\"bg-white p-6 rounded-lg shadow-md\">\r\n        <h2 className=\"text-xl font-semibold mb-4\">S·∫£n ph·∫©m c√≥ s·∫µn</h2>\r\n        <p className=\"text-gray-500 text-center py-8\">Ch∆∞a c√≥ s·∫£n ph·∫©m n√†o trong ch·ª£. H√£y th√™m s·∫£n ph·∫©m ƒë·∫ßu ti√™n!</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"bg-white p-6 rounded-lg shadow-md\">\r\n      <h2 className=\"text-xl font-semibold mb-4\">S·∫£n ph·∫©m c√≥ s·∫µn ({availableItems.length})</h2>\r\n      \r\n      {availableItems.length > 0 && (\r\n        <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4\">\r\n          <div className=\"flex items-start\">\r\n            <svg className=\"w-5 h-5 text-yellow-400 mt-0.5 mr-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n              <path fillRule=\"evenodd\" d=\"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\" clipRule=\"evenodd\" />\r\n            </svg>\r\n            <div>\r\n              <h4 className=\"text-yellow-800 font-medium text-sm\">L∆∞u √Ω thanh to√°n</h4>\r\n              <p className=\"text-yellow-700 text-xs mt-1\">\r\n                Thanh to√°n s·∫Ω s·ª≠ d·ª•ng IOTA t·ª´ v√≠ c·ªßa b·∫°n (8.58 IOTA c√≥ s·∫µn). \r\n                C·∫ßn ƒë·ªß ti·ªÅn cho: gi√° s·∫£n ph·∫©m + ph√≠ gas (~0.01 IOTA).\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n        {availableItems.map((item, index) => (\r\n          <div key={item.id} className=\"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow\">\r\n            <h3 className=\"font-semibold text-lg mb-2 text-gray-800\">{item.name}</h3>\r\n            <p className=\"text-blue-600 font-bold text-xl mb-2\">{item.price} IOTA</p>\r\n            <p className=\"text-gray-600 text-sm mb-4\">\r\n              B√°n b·ªüi: {item.seller.slice(0, 6)}...{item.seller.slice(-4)}\r\n              {item.seller === currentUser && (\r\n                <span className=\"ml-2 bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded\">\r\n                  C·ªßa b·∫°n\r\n                </span>\r\n              )}\r\n            </p>\r\n            <button\r\n              onClick={() => handleBuyClick(index, item.price)}\r\n              disabled={isLoading}\r\n              className=\"w-full bg-green-500 text-white py-2 px-4 rounded-md hover:bg-green-600 disabled:bg-gray-400 disabled:cursor-not-allowed\"\r\n            >\r\n              {isLoading ? \"ƒêang x·ª≠ l√Ω...\" : \"Mua ngay\"}\r\n            </button>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":";;;;;AAAA;;AAiBe,SAAS,SAAS,EAAE,KAAK,EAAE,SAAS,EAAE,WAAW,EAAE,YAAY,KAAK,EAAiB;IAClG,MAAM,iBAAiB,MAAM,MAAM,CAAC,CAAA,OAAQ,CAAC,KAAK,IAAI;IAEtD,MAAM,iBAAiB,OAAO,WAAmB;QAC/C,QAAQ,GAAG,CAAC,CAAC,2CAA2C,EAAE,UAAU,QAAQ,EAAE,OAAO;QACrF,IAAI;YACF,MAAM,UAAU,WAAW;QAC7B,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,sBAAsB;QACtC;IACF;IAEA,IAAI,eAAe,MAAM,KAAK,GAAG;QAC/B,qBACE,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAG,WAAU;8BAA6B;;;;;;8BAC3C,6LAAC;oBAAE,WAAU;8BAAiC;;;;;;;;;;;;IAGpD;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAG,WAAU;;oBAA6B;oBAAkB,eAAe,MAAM;oBAAC;;;;;;;YAElF,eAAe,MAAM,GAAG,mBACvB,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAI,WAAU;4BAAsC,MAAK;4BAAe,SAAQ;sCAC/E,cAAA,6LAAC;gCAAK,UAAS;gCAAU,GAAE;gCAAoN,UAAS;;;;;;;;;;;sCAE1P,6LAAC;;8CACC,6LAAC;oCAAG,WAAU;8CAAsC;;;;;;8CACpD,6LAAC;oCAAE,WAAU;8CAA+B;;;;;;;;;;;;;;;;;;;;;;;0BASpD,6LAAC;gBAAI,WAAU;0BACZ,eAAe,GAAG,CAAC,CAAC,MAAM,sBACzB,6LAAC;wBAAkB,WAAU;;0CAC3B,6LAAC;gCAAG,WAAU;0CAA4C,KAAK,IAAI;;;;;;0CACnE,6LAAC;gCAAE,WAAU;;oCAAwC,KAAK,KAAK;oCAAC;;;;;;;0CAChE,6LAAC;gCAAE,WAAU;;oCAA6B;oCAC9B,KAAK,MAAM,CAAC,KAAK,CAAC,GAAG;oCAAG;oCAAI,KAAK,MAAM,CAAC,KAAK,CAAC,CAAC;oCACxD,KAAK,MAAM,KAAK,6BACf,6LAAC;wCAAK,WAAU;kDAA2D;;;;;;;;;;;;0CAK/E,6LAAC;gCACC,SAAS,IAAM,eAAe,OAAO,KAAK,KAAK;gCAC/C,UAAU;gCACV,WAAU;0CAET,YAAY,kBAAkB;;;;;;;uBAhBzB,KAAK,EAAE;;;;;;;;;;;;;;;;AAuB3B;KAnEwB"}},
    {"offset": {"line": 435, "column": 0}, "map": {"version":3,"sources":["file:///home/truongdo1z/marketplace/components/TransactionHistory.tsx"],"sourcesContent":["\"use client\";\r\n\r\ninterface Transaction {\r\n  item_id: string;\r\n  item_name: string;\r\n  price: number;\r\n  seller: string;\r\n  buyer: string;\r\n  timestamp: number;\r\n}\r\n\r\ninterface TransactionHistoryProps {\r\n  transactions: Transaction[];\r\n  currentUser?: string;\r\n}\r\n\r\nexport default function TransactionHistory({ transactions, currentUser }: TransactionHistoryProps) {\r\n  const userTransactions = currentUser \r\n    ? transactions.filter(tx => tx.seller === currentUser || tx.buyer === currentUser)\r\n    : transactions;\r\n\r\n  const formatDate = (timestamp: number) => {\r\n    return new Date(timestamp).toLocaleString('vi-VN');\r\n  };\r\n\r\n  const formatAddress = (address: string) => {\r\n    return `${address.slice(0, 6)}...${address.slice(-4)}`;\r\n  };\r\n\r\n  if (userTransactions.length === 0) {\r\n    return (\r\n      <div className=\"bg-white p-6 rounded-lg shadow-md\">\r\n        <h2 className=\"text-xl font-semibold mb-4 text-gray-800\">L·ªãch s·ª≠ giao d·ªãch</h2>\r\n        <p className=\"text-gray-500 text-center py-8\">Ch∆∞a c√≥ giao d·ªãch n√†o</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"bg-white p-6 rounded-lg shadow-md\">\r\n      <h2 className=\"text-xl font-semibold mb-4 text-gray-800\">L·ªãch s·ª≠ giao d·ªãch ({userTransactions.length})</h2>\r\n      <div className=\"overflow-x-auto\">\r\n        <table className=\"w-full text-sm text-left\">\r\n          <thead className=\"text-xs text-gray-700 uppercase bg-gray-50\">\r\n            <tr>\r\n              <th scope=\"col\" className=\"px-6 py-3\">S·∫£n ph·∫©m</th>\r\n              <th scope=\"col\" className=\"px-6 py-3\">Gi√°</th>\r\n              <th scope=\"col\" className=\"px-6 py-3\">Ng∆∞·ªùi b√°n</th>\r\n              <th scope=\"col\" className=\"px-6 py-3\">Ng∆∞·ªùi mua</th>\r\n              <th scope=\"col\" className=\"px-6 py-3\">Th·ªùi gian</th>\r\n              <th scope=\"col\" className=\"px-6 py-3\">Vai tr√≤</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {userTransactions.map((tx, index) => {\r\n              const isBuyer = tx.buyer === currentUser;\r\n              const isSeller = tx.seller === currentUser;\r\n              \r\n              return (\r\n                <tr key={index} className=\"bg-white border-b hover:bg-gray-50\">\r\n                  <td className=\"px-6 py-4 font-medium text-gray-900\">\r\n                    {tx.item_name}\r\n                  </td>\r\n                  <td className=\"px-6 py-4 text-blue-600 font-semibold\">\r\n                    {tx.price} IOTA\r\n                  </td>\r\n                  <td className=\"px-6 py-4\">\r\n                    <span className={isSeller ? \"font-semibold text-green-600\" : \"\"}>\r\n                      {formatAddress(tx.seller)}\r\n                    </span>\r\n                  </td>\r\n                  <td className=\"px-6 py-4\">\r\n                    <span className={isBuyer ? \"font-semibold text-blue-600\" : \"\"}>\r\n                      {formatAddress(tx.buyer)}\r\n                    </span>\r\n                  </td>\r\n                  <td className=\"px-6 py-4 text-gray-600\">\r\n                    {formatDate(tx.timestamp)}\r\n                  </td>\r\n                  <td className=\"px-6 py-4\">\r\n                    {isBuyer && (\r\n                      <span className=\"bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded\">\r\n                        Mua\r\n                      </span>\r\n                    )}\r\n                    {isSeller && (\r\n                      <span className=\"bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded\">\r\n                        B√°n\r\n                      </span>\r\n                    )}\r\n                    {!isBuyer && !isSeller && (\r\n                      <span className=\"bg-gray-100 text-gray-800 text-xs font-medium px-2.5 py-0.5 rounded\">\r\n                        Kh√°c\r\n                      </span>\r\n                    )}\r\n                  </td>\r\n                </tr>\r\n              );\r\n            })}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":";;;;;AAAA;;AAgBe,SAAS,mBAAmB,EAAE,YAAY,EAAE,WAAW,EAA2B;IAC/F,MAAM,mBAAmB,cACrB,aAAa,MAAM,CAAC,CAAA,KAAM,GAAG,MAAM,KAAK,eAAe,GAAG,KAAK,KAAK,eACpE;IAEJ,MAAM,aAAa,CAAC;QAClB,OAAO,IAAI,KAAK,WAAW,cAAc,CAAC;IAC5C;IAEA,MAAM,gBAAgB,CAAC;QACrB,OAAO,GAAG,QAAQ,KAAK,CAAC,GAAG,GAAG,GAAG,EAAE,QAAQ,KAAK,CAAC,CAAC,IAAI;IACxD;IAEA,IAAI,iBAAiB,MAAM,KAAK,GAAG;QACjC,qBACE,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAG,WAAU;8BAA2C;;;;;;8BACzD,6LAAC;oBAAE,WAAU;8BAAiC;;;;;;;;;;;;IAGpD;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAG,WAAU;;oBAA2C;oBAAoB,iBAAiB,MAAM;oBAAC;;;;;;;0BACrG,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAM,WAAU;;sCACf,6LAAC;4BAAM,WAAU;sCACf,cAAA,6LAAC;;kDACC,6LAAC;wCAAG,OAAM;wCAAM,WAAU;kDAAY;;;;;;kDACtC,6LAAC;wCAAG,OAAM;wCAAM,WAAU;kDAAY;;;;;;kDACtC,6LAAC;wCAAG,OAAM;wCAAM,WAAU;kDAAY;;;;;;kDACtC,6LAAC;wCAAG,OAAM;wCAAM,WAAU;kDAAY;;;;;;kDACtC,6LAAC;wCAAG,OAAM;wCAAM,WAAU;kDAAY;;;;;;kDACtC,6LAAC;wCAAG,OAAM;wCAAM,WAAU;kDAAY;;;;;;;;;;;;;;;;;sCAG1C,6LAAC;sCACE,iBAAiB,GAAG,CAAC,CAAC,IAAI;gCACzB,MAAM,UAAU,GAAG,KAAK,KAAK;gCAC7B,MAAM,WAAW,GAAG,MAAM,KAAK;gCAE/B,qBACE,6LAAC;oCAAe,WAAU;;sDACxB,6LAAC;4CAAG,WAAU;sDACX,GAAG,SAAS;;;;;;sDAEf,6LAAC;4CAAG,WAAU;;gDACX,GAAG,KAAK;gDAAC;;;;;;;sDAEZ,6LAAC;4CAAG,WAAU;sDACZ,cAAA,6LAAC;gDAAK,WAAW,WAAW,iCAAiC;0DAC1D,cAAc,GAAG,MAAM;;;;;;;;;;;sDAG5B,6LAAC;4CAAG,WAAU;sDACZ,cAAA,6LAAC;gDAAK,WAAW,UAAU,gCAAgC;0DACxD,cAAc,GAAG,KAAK;;;;;;;;;;;sDAG3B,6LAAC;4CAAG,WAAU;sDACX,WAAW,GAAG,SAAS;;;;;;sDAE1B,6LAAC;4CAAG,WAAU;;gDACX,yBACC,6LAAC;oDAAK,WAAU;8DAAsE;;;;;;gDAIvF,0BACC,6LAAC;oDAAK,WAAU;8DAAwE;;;;;;gDAIzF,CAAC,WAAW,CAAC,0BACZ,6LAAC;oDAAK,WAAU;8DAAsE;;;;;;;;;;;;;mCAhCnF;;;;;4BAuCb;;;;;;;;;;;;;;;;;;;;;;;AAMZ;KAxFwB"}},
    {"offset": {"line": 703, "column": 0}, "map": {"version":3,"sources":["file:///home/truongdo1z/marketplace/hooks/useMarketplace.ts"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState } from \"react\"\r\nimport {\r\n  useCurrentAccount,\r\n  useSignAndExecuteTransaction,\r\n  useIotaClientQuery,\r\n  useIotaClient,\r\n} from \"@iota/dapp-kit\"\r\nimport { Transaction } from \"@iota/iota-sdk/transactions\"\r\nimport { useNetworkVariable } from \"@/lib/config\"\r\n\r\n// Marketplace contract configuration\r\nconst MARKETPLACE_MODULE = \"contract\"\r\nconst MARKETPLACE_METHODS = {\r\n  CREATE: \"create\",\r\n  ADD_ITEM: \"add_item\",\r\n  BUY_ITEM: \"buy_item\",\r\n  GET_AVAILABLE_ITEMS: \"get_available_items\",\r\n  GET_TRANSACTION_HISTORY: \"get_transaction_history\",\r\n} as const\r\n\r\nexport interface MarketplaceItem {\r\n  item_id: number\r\n  name: string\r\n  price: number\r\n  seller: string\r\n  sold: boolean\r\n}\r\n\r\nexport interface MarketplaceTransaction {\r\n  item_id: number\r\n  item_name: string\r\n  price: number\r\n  seller: string\r\n  buyer: string\r\n  timestamp: number\r\n}\r\n\r\nexport function useMarketplace() {\r\n  const account = useCurrentAccount()\r\n  const { mutate: signAndExecute } = useSignAndExecuteTransaction()\r\n  const packageId = useNetworkVariable(\"packageId\")\r\n  const iotaClient = useIotaClient()\r\n  \r\n  const [isLoading, setIsLoading] = useState(false)\r\n  const [error, setError] = useState<Error | null>(null)\r\n  const [marketplaceId, setMarketplaceId] = useState<string | null>(null)\r\n\r\n  // Create marketplace\r\n  const createMarketplace = async (): Promise<string> => {\r\n    if (!packageId || !account) {\r\n      throw new Error(\"Package ID or account not available\")\r\n    }\r\n\r\n    try {\r\n      setIsLoading(true)\r\n      setError(null)\r\n      \r\n      const tx = new Transaction()\r\n      tx.moveCall({\r\n        arguments: [],\r\n        target: `${packageId}::${MARKETPLACE_MODULE}::${MARKETPLACE_METHODS.CREATE}`,\r\n      })\r\n\r\n      return new Promise((resolve, reject) => {\r\n        signAndExecute(\r\n          { transaction: tx as any },\r\n          {\r\n            onSuccess: async ({ digest }) => {\r\n              try {\r\n                console.log(\"Marketplace creation transaction:\", digest)\r\n                // Wait for transaction and get the created object ID\r\n                const { effects } = await iotaClient.waitForTransaction({\r\n                  digest,\r\n                  options: { showEffects: true },\r\n                })\r\n                const newObjectId = effects?.created?.[0]?.reference?.objectId\r\n                if (newObjectId) {\r\n                  console.log(\"Created marketplace object ID:\", newObjectId)\r\n                  resolve(newObjectId)\r\n                } else {\r\n                  reject(new Error(\"No object ID found in transaction effects\"))\r\n                }\r\n              } catch (waitError) {\r\n                reject(waitError)\r\n              } finally {\r\n                setIsLoading(false)\r\n              }\r\n            },\r\n            onError: (err) => {\r\n              const error = err instanceof Error ? err : new Error(String(err))\r\n              setError(error)\r\n              reject(error)\r\n              setIsLoading(false)\r\n            },\r\n          }\r\n        )\r\n      })\r\n    } catch (err) {\r\n      const error = err instanceof Error ? err : new Error(String(err))\r\n      setError(error)\r\n      setIsLoading(false)\r\n      throw error\r\n    }\r\n  }\r\n\r\n  // Add item to marketplace\r\n  const addItem = async (name: string, price: number, marketplaceObjectId: string) => {\r\n    if (!packageId || !account) {\r\n      throw new Error(\"Package ID or account not available\")\r\n    }\r\n\r\n    try {\r\n      setIsLoading(true)\r\n      setError(null)\r\n      \r\n      // Convert price to mist (IOTA's smallest unit: 1 IOTA = 1,000,000,000 mist)\r\n      // Input price is already in IOTA, so multiply by 1B to get mist\r\n      const priceInMist = Math.round(price * 1000000000)\r\n\r\n      const tx = new Transaction()\r\n      tx.moveCall({\r\n        arguments: [\r\n          tx.object(marketplaceObjectId),\r\n          tx.pure.string(name),\r\n          tx.pure.u64(priceInMist),\r\n        ],\r\n        target: `${packageId}::${MARKETPLACE_MODULE}::${MARKETPLACE_METHODS.ADD_ITEM}`,\r\n      })\r\n\r\n      return new Promise((resolve, reject) => {\r\n        signAndExecute(\r\n          { transaction: tx as any },\r\n          {\r\n            onSuccess: async ({ digest }) => {\r\n              try {\r\n                console.log(\"Add item transaction:\", digest)\r\n                resolve(digest)\r\n              } catch (waitError) {\r\n                reject(waitError)\r\n              } finally {\r\n                setIsLoading(false)\r\n              }\r\n            },\r\n            onError: (err) => {\r\n              const error = err instanceof Error ? err : new Error(String(err))\r\n              setError(error)\r\n              reject(error)\r\n              setIsLoading(false)\r\n            },\r\n          }\r\n        )\r\n      })\r\n    } catch (err) {\r\n      const error = err instanceof Error ? err : new Error(String(err))\r\n      setError(error)\r\n      setIsLoading(false)\r\n      throw error\r\n    }\r\n  }\r\n\r\n  // Buy item from marketplace\r\n  const buyItem = async (itemIndex: number, payment: number, marketplaceObjectId: string) => {\r\n    if (!packageId || !account) {\r\n      throw new Error(\"Package ID or account not available\")\r\n    }\r\n\r\n    try {\r\n      setIsLoading(true)\r\n      setError(null)\r\n\r\n      console.log(`Buying item: index=${itemIndex}, payment=${payment} IOTA (type: ${typeof payment}), marketplaceId=${marketplaceObjectId}`)\r\n\r\n      // Convert payment to mist using BigInt to avoid floating point precision issues\r\n      // IOTA uses 9 decimal places (1 IOTA = 1,000,000,000 mist)\r\n      \r\n      const MIST_DECIMALS = 9\r\n      const paymentStr = payment.toString()\r\n      \r\n      let [integerPart, decimalPart = \"\"] = paymentStr.split(\".\")\r\n      \r\n      // Pad or truncate decimal part to exactly 9 digits\r\n      if (decimalPart.length < MIST_DECIMALS) {\r\n        decimalPart = decimalPart.padEnd(MIST_DECIMALS, '0')\r\n      } else {\r\n        decimalPart = decimalPart.substring(0, MIST_DECIMALS)\r\n      }\r\n      \r\n      // Combine integer and decimal parts\r\n      const fullMistString = integerPart + decimalPart\r\n      const paymentInMist = parseInt(fullMistString, 10)\r\n      \r\n      console.log(`Payment conversion with BigInt precision:`)\r\n      console.log(`  Original: ${payment} IOTA`)\r\n      console.log(`  String representation: \"${paymentStr}\"`)\r\n      console.log(`  Integer part: \"${integerPart}\"`)\r\n      console.log(`  Decimal part: \"${decimalPart}\" (padded to 9 digits)`)\r\n      console.log(`  Combined string: \"${fullMistString}\"`)\r\n      console.log(`  Final mist value: ${paymentInMist}`)\r\n      console.log(`  Back to IOTA: ${paymentInMist / Math.pow(10, MIST_DECIMALS)}`)\r\n      console.log(`  Expected exactly: ${payment === paymentInMist / Math.pow(10, MIST_DECIMALS) ? 'MATCH' : 'MISMATCH'}`)\r\n      \r\n      // Validate payment amount\r\n      if (paymentInMist <= 0 || !Number.isInteger(paymentInMist)) {\r\n        throw new Error(`Invalid payment amount: ${payment} IOTA (${paymentInMist} mist)`)\r\n      }\r\n      \r\n      console.log(`Creating transaction for wallet payment`)\r\n\r\n      const tx = new Transaction()\r\n      \r\n      // Use a smaller gas budget to avoid confusion\r\n      tx.setGasBudget(100000000) // 0.1 IOTA gas budget (smaller than payment)\r\n      \r\n      // Create payment by splitting from gas coin\r\n      // NOTE: This might be the issue - using gas coin for payment\r\n      console.log(`WARNING: Using gas coin for payment. Gas budget: 100000000 mist, Payment: ${paymentInMist} mist`)\r\n      \r\n      // Log the exact u64 value being sent\r\n      const u64Value = tx.pure.u64(paymentInMist)\r\n      console.log(`tx.pure.u64() value:`, u64Value)\r\n      console.log(`Raw paymentInMist value: ${paymentInMist}`)\r\n      console.log(`PaymentInMist as hex: 0x${paymentInMist.toString(16)}`)\r\n      \r\n      const [paymentCoin] = tx.splitCoins(tx.gas, [u64Value])\r\n      \r\n      // Buy item using the payment coin\r\n      const remainingCoin = tx.moveCall({\r\n        arguments: [\r\n          tx.object(marketplaceObjectId),\r\n          tx.pure.u64(itemIndex),\r\n          paymentCoin,\r\n        ],\r\n        target: `${packageId}::${MARKETPLACE_MODULE}::${MARKETPLACE_METHODS.BUY_ITEM}`,\r\n      })\r\n\r\n      // Transfer remaining coins back to buyer  \r\n      tx.transferObjects([remainingCoin], account.address)\r\n\r\n      console.log(\"Transaction prepared with proper gas budget, executing...\")\r\n\r\n      return new Promise((resolve, reject) => {\r\n        signAndExecute(\r\n          { transaction: tx as any },\r\n          {\r\n            onSuccess: async ({ digest }) => {\r\n              try {\r\n                console.log(\"Buy item transaction successful:\", digest)\r\n                resolve(digest)\r\n              } catch (waitError) {\r\n                console.error(\"Wait error:\", waitError)\r\n                reject(waitError)\r\n              } finally {\r\n                setIsLoading(false)\r\n              }\r\n            },\r\n            onError: (err) => {\r\n              const error = err instanceof Error ? err : new Error(String(err))\r\n              console.error(\"Buy item transaction failed:\", error)\r\n              console.error(\"Error details:\", {\r\n                message: error.message,\r\n                paymentInMist,\r\n                paymentInIOTA: payment,\r\n                itemIndex,\r\n                marketplaceObjectId\r\n              })\r\n              setError(error)\r\n              reject(error)\r\n              setIsLoading(false)\r\n            },\r\n          }\r\n        )\r\n      })\r\n    } catch (err) {\r\n      const error = err instanceof Error ? err : new Error(String(err))\r\n      setError(error)\r\n      setIsLoading(false)\r\n      throw error\r\n    }\r\n  }\r\n\r\n  // Query available items from marketplace\r\n  const getAvailableItems = async (marketplaceObjectId: string): Promise<MarketplaceItem[]> => {\r\n    if (!packageId || !iotaClient) {\r\n      throw new Error(\"Package ID or client not available\")\r\n    }\r\n\r\n    try {\r\n      // Call the contract view function\r\n      const result = await iotaClient.devInspectTransactionBlock({\r\n        transactionBlock: (() => {\r\n          const tx = new Transaction()\r\n          tx.moveCall({\r\n            arguments: [tx.object(marketplaceObjectId)],\r\n            target: `${packageId}::${MARKETPLACE_MODULE}::${MARKETPLACE_METHODS.GET_AVAILABLE_ITEMS}`,\r\n          })\r\n          return tx\r\n        })() as any,\r\n        sender: account?.address || \"0x0\",\r\n      })\r\n\r\n      // Parse the result (this will need to be adapted based on the actual response format)\r\n      console.log(\"Get available items result:\", result)\r\n      return []\r\n    } catch (error) {\r\n      console.error(\"Error getting available items:\", error)\r\n      throw error\r\n    }\r\n  }\r\n\r\n  // Query transaction history from marketplace\r\n  const getTransactionHistory = async (marketplaceObjectId: string): Promise<MarketplaceTransaction[]> => {\r\n    if (!packageId || !iotaClient) {\r\n      throw new Error(\"Package ID or client not available\")\r\n    }\r\n\r\n    try {\r\n      const result = await iotaClient.devInspectTransactionBlock({\r\n        transactionBlock: (() => {\r\n          const tx = new Transaction()\r\n          tx.moveCall({\r\n            arguments: [tx.object(marketplaceObjectId)],\r\n            target: `${packageId}::${MARKETPLACE_MODULE}::${MARKETPLACE_METHODS.GET_TRANSACTION_HISTORY}`,\r\n          })\r\n          return tx\r\n        })() as any,\r\n        sender: account?.address || \"0x0\",\r\n      })\r\n\r\n      console.log(\"Get transaction history result:\", result)\r\n      return []\r\n    } catch (error) {\r\n      console.error(\"Error getting transaction history:\", error)\r\n      throw error\r\n    }\r\n  }\r\n\r\n  return {\r\n    createMarketplace,\r\n    addItem,\r\n    buyItem,\r\n    getAvailableItems,\r\n    getTransactionHistory,\r\n    isLoading,\r\n    error,\r\n    account,\r\n    marketplaceId,\r\n    setMarketplaceId,\r\n  }\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1024, "column": 0}, "map": {"version":3,"sources":["file:///home/truongdo1z/marketplace/components/MarketplaceApp.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { useCurrentAccount, useIotaClientQuery } from \"@iota/dapp-kit\";\r\nimport AddItemForm from \"./AddItemForm\";\r\nimport ItemList from \"./ItemList\";\r\nimport TransactionHistory from \"./TransactionHistory\";\r\nimport { useMarketplace } from \"@/hooks/useMarketplace\";\r\nimport { useNetworkVariable } from \"@/lib/config\";\r\n\r\ninterface Item {\r\n  id: string;\r\n  name: string;\r\n  price: number;\r\n  seller: string;\r\n  sold: boolean;\r\n}\r\n\r\ninterface Transaction {\r\n  item_id: string;\r\n  item_name: string;\r\n  price: number;\r\n  seller: string;\r\n  buyer: string;\r\n  timestamp: number;\r\n}\r\n\r\nexport default function MarketplaceApp() {\r\n  const account = useCurrentAccount();\r\n  const packageId = useNetworkVariable(\"packageId\");\r\n  const { addItem, buyItem, createMarketplace, getAvailableItems, getTransactionHistory, isLoading: contractLoading, error: contractError } = useMarketplace();\r\n  const [items, setItems] = useState<Item[]>([]);\r\n  const [transactions, setTransactions] = useState<Transaction[]>([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [activeTab, setActiveTab] = useState<'market' | 'history'>('market');\r\n  const [marketplaceId, setMarketplaceId] = useState<string | null>(null);\r\n  \r\n  // Initialize marketplace when component mounts\r\n  useEffect(() => {\r\n    const initializeMarketplace = async () => {\r\n      // Check if marketplace ID exists in localStorage\r\n      const storedMarketplaceId = localStorage.getItem('marketplaceId');\r\n      \r\n      // Validate stored marketplace ID - must start with 0x and be proper length\r\n      const isValidObjectId = storedMarketplaceId && \r\n        storedMarketplaceId.startsWith('0x') && \r\n        storedMarketplaceId.length > 20 &&\r\n        !storedMarketplaceId.includes('marketplace_');\r\n      \r\n      if (isValidObjectId) {\r\n        console.log(\"Using stored marketplace ID:\", storedMarketplaceId);\r\n        setMarketplaceId(storedMarketplaceId);\r\n      } else {\r\n        // Clear invalid marketplace ID\r\n        if (storedMarketplaceId) {\r\n          console.log(\"Clearing invalid marketplace ID:\", storedMarketplaceId);\r\n          localStorage.removeItem('marketplaceId');\r\n        }\r\n        \r\n        if (account) {\r\n          // Create new marketplace if none exists or invalid\r\n          try {\r\n            console.log(\"Creating new marketplace...\");\r\n            const newMarketplaceId = await createMarketplace();\r\n            console.log(\"Created marketplace with ID:\", newMarketplaceId);\r\n            setMarketplaceId(newMarketplaceId);\r\n            localStorage.setItem('marketplaceId', newMarketplaceId);\r\n          } catch (error) {\r\n            console.error(\"Failed to create marketplace:\", error);\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    initializeMarketplace();\r\n  }, [account]); // üîß Ch·ªâ depend v√†o account, lo·∫°i b·ªè createMarketplace\r\n  \r\n  // Load real data from contract when marketplace changes\r\n  useEffect(() => {\r\n    const loadMarketplaceData = async () => {\r\n      if (marketplaceId && packageId && account) {\r\n        try {\r\n          setIsLoading(true);\r\n          console.log(\"Loading marketplace data for:\", marketplaceId);\r\n          \r\n          // For now, use mock data since we need to properly handle contract responses\r\n          // TODO: Implement proper contract data parsing\r\n          \r\n          // Start with empty marketplace - users will add their own items\r\n          setItems([]);\r\n          setTransactions([]);\r\n          \r\n        } catch (error) {\r\n          console.error(\"Error loading marketplace data:\", error);\r\n        } finally {\r\n          setIsLoading(false);\r\n        }\r\n      }\r\n    };\r\n\r\n    loadMarketplaceData();\r\n  }, [marketplaceId, packageId, account]);\r\n\r\n  const handleAddItem = async (name: string, priceStr: string) => {\r\n    if (!account) {\r\n      alert(\"Vui l√≤ng k·∫øt n·ªëi v√≠ tr∆∞·ªõc\");\r\n      return;\r\n    }\r\n\r\n    if (!marketplaceId) {\r\n      alert(\"Marketplace ch∆∞a ƒë∆∞·ª£c kh·ªüi t·∫°o\");\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      const price = parseFloat(priceStr);\r\n      if (isNaN(price) || price <= 0) {\r\n        alert(\"Gi√° kh√¥ng h·ª£p l·ªá\");\r\n        return;\r\n      }\r\n\r\n      // Call smart contract\r\n      await addItem(name, price, marketplaceId);\r\n      \r\n      // Add to local state immediately for better UX\r\n      // Use timestamp + random for unique ID\r\n      const newItemId = `user_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n      const newItem: Item = {\r\n        id: newItemId,\r\n        name,\r\n        price,\r\n        seller: account.address,\r\n        sold: false\r\n      };\r\n      setItems(prev => [...prev, newItem]);\r\n      \r\n      alert(`‚úÖ ƒê√£ th√™m s·∫£n ph·∫©m \"${name}\" v·ªõi gi√° ${price} IOTA\\n\\nüí° B·∫°n v·ª´a tr·∫£ ph√≠ gas nh·ªè ƒë·ªÉ ghi d·ªØ li·ªáu l√™n blockchain. Khi c√≥ ng∆∞·ªùi mua, b·∫°n s·∫Ω nh·∫≠n ƒë∆∞·ª£c ${price} IOTA (tr·ª´ ph√≠ gas cho buyer).`);\r\n    } catch (error) {\r\n      console.error(\"Error adding item:\", error);\r\n      alert(`C√≥ l·ªói x·∫£y ra khi th√™m s·∫£n ph·∫©m: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleBuyItem = async (itemIndex: number, price: number) => {\r\n    if (!account) {\r\n      alert(\"Vui l√≤ng k·∫øt n·ªëi v√≠ tr∆∞·ªõc\");\r\n      return;\r\n    }\r\n\r\n    if (!marketplaceId) {\r\n      alert(\"Marketplace ch∆∞a ƒë∆∞·ª£c kh·ªüi t·∫°o\");\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      // Get available items (not sold)\r\n      const availableItems = items.filter(item => !item.sold);\r\n      const item = availableItems[itemIndex];\r\n      \r\n      if (!item || item.sold) {\r\n        alert(\"S·∫£n ph·∫©m kh√¥ng t·ªìn t·∫°i ho·∫∑c ƒë√£ ƒë∆∞·ª£c b√°n\");\r\n        return;\r\n      }\r\n\r\n      console.log(`Attempting to buy item:`, {\r\n        itemIndex,\r\n        price,\r\n        itemName: item.name,\r\n        itemSeller: item.seller,\r\n        buyerAddress: account.address,\r\n        marketplaceId\r\n      });\r\n      \r\n      // Check if this is a demo item (skip contract call for demo items)\r\n      if (item.id.startsWith('demo')) {\r\n        alert(\"ƒê√¢y l√† demo item. Vui l√≤ng th√™m s·∫£n ph·∫©m th·∫≠t ƒë·ªÉ test mua b√°n v·ªõi blockchain!\");\r\n        return;\r\n      } else {\r\n        // Real contract purchase for user-added items\r\n        // Find the real index in the contract (excluding demo items)\r\n        const realItems = items.filter(item => !item.id.startsWith('demo'));\r\n        const realIndex = realItems.findIndex(i => i.id === item.id);\r\n        \r\n        if (realIndex === -1) {\r\n          alert(\"Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m trong contract\");\r\n          return;\r\n        }\r\n        \r\n        console.log(`Real contract purchase: item index ${realIndex} in contract`);\r\n        console.log(`MarketplaceApp: Calling buyItem with price=${price} (type: ${typeof price})`);\r\n        await buyItem(realIndex, price, marketplaceId);\r\n\r\n        // Update local state after successful purchase\r\n        const originalIndex = items.findIndex(i => i.id === item.id);\r\n        setItems(prev => prev.map((item, idx) => \r\n          idx === originalIndex ? { ...item, sold: true } : item\r\n        ));\r\n\r\n        // Add transaction record\r\n        const newTransaction: Transaction = {\r\n          item_id: item.id,\r\n          item_name: item.name,\r\n          price: item.price,\r\n          seller: item.seller,\r\n          buyer: account.address,\r\n          timestamp: Date.now()\r\n        };\r\n        setTransactions(prev => [...prev, newTransaction]);\r\n        \r\n        alert(`ƒê√£ mua th√†nh c√¥ng \"${item.name}\" v·ªõi gi√° ${price} IOTA`);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error buying item:\", error);\r\n      const errorMessage = error instanceof Error ? error.message : 'Unknown error';\r\n      alert(`C√≥ l·ªói x·∫£y ra khi mua s·∫£n ph·∫©m: ${errorMessage}`);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  if (!account) {\r\n    return (\r\n      <div className=\"bg-white p-8 rounded-lg shadow-md text-center\">\r\n        <h2 className=\"text-xl font-semibold mb-4\">IOTA Marketplace</h2>\r\n        <p className=\"text-gray-600 mb-4\">Vui l√≤ng k·∫øt n·ªëi v√≠ IOTA ƒë·ªÉ s·ª≠ d·ª•ng marketplace</p>\r\n        <p className=\"text-sm text-gray-500\">\r\n          B·∫°n c·∫ßn m·ªôt v√≠ IOTA ƒë·ªÉ th·ª±c hi·ªán giao d·ªãch mua b√°n\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!marketplaceId) {\r\n    return (\r\n      <div className=\"bg-white p-8 rounded-lg shadow-md text-center\">\r\n        <h2 className=\"text-xl font-semibold mb-4\">ƒêang kh·ªüi t·∫°o Marketplace...</h2>\r\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto\"></div>\r\n        <p className=\"text-gray-600 mt-4\">Vui l√≤ng ch·ªù trong khi ch√∫ng t√¥i thi·∫øt l·∫≠p marketplace</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Error display */}\r\n      {contractError && (\r\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\r\n          <h3 className=\"text-red-800 font-semibold\">L·ªói giao d·ªãch:</h3>\r\n          <p className=\"text-red-600 text-sm\">{contractError.message}</p>\r\n        </div>\r\n      )}\r\n\r\n      {/* Marketplace ID display */}\r\n      <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div>\r\n            <h3 className=\"text-blue-800 font-semibold\">Marketplace ID:</h3>\r\n            <p className=\"text-blue-600 text-sm font-mono\">{marketplaceId}</p>\r\n          </div>\r\n          <div className=\"flex gap-2\">\r\n            <button\r\n              onClick={() => {\r\n                const newId = prompt(\"Nh·∫≠p Marketplace Object ID:\", marketplaceId || \"\");\r\n                if (newId && newId.trim()) {\r\n                  setMarketplaceId(newId.trim());\r\n                  localStorage.setItem('marketplaceId', newId.trim());\r\n                }\r\n              }}\r\n              className=\"px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700\"\r\n            >\r\n              Thay ƒë·ªïi\r\n            </button>\r\n            <button\r\n              onClick={async () => {\r\n                if (confirm(\"B·∫°n c√≥ mu·ªën t·∫°o marketplace m·ªõi kh√¥ng? Marketplace hi·ªán t·∫°i s·∫Ω b·ªã thay th·∫ø.\")) {\r\n                  localStorage.removeItem('marketplaceId');\r\n                  setMarketplaceId(null);\r\n                  try {\r\n                    console.log(\"Creating new marketplace...\");\r\n                    const newMarketplaceId = await createMarketplace();\r\n                    console.log(\"Created new marketplace with ID:\", newMarketplaceId);\r\n                    setMarketplaceId(newMarketplaceId);\r\n                    localStorage.setItem('marketplaceId', newMarketplaceId);\r\n                  } catch (error) {\r\n                    console.error(\"Failed to create new marketplace:\", error);\r\n                    alert(\"C√≥ l·ªói x·∫£y ra khi t·∫°o marketplace m·ªõi: \" + (error instanceof Error ? error.message : 'Unknown error'));\r\n                  }\r\n                }\r\n              }}\r\n              className=\"px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700\"\r\n            >\r\n              T·∫°o m·ªõi\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Navigation Tabs */}\r\n      <div className=\"bg-white p-1 rounded-lg shadow-md\">\r\n        <nav className=\"flex space-x-1\">\r\n          <button\r\n            onClick={() => setActiveTab('market')}\r\n            className={`flex-1 py-2 px-4 text-sm font-medium rounded-md ${\r\n              activeTab === 'market'\r\n                ? 'bg-blue-500 text-white'\r\n                : 'text-gray-500 hover:text-gray-700'\r\n            }`}\r\n          >\r\n            Th·ªã tr∆∞·ªùng\r\n          </button>\r\n          <button\r\n            onClick={() => setActiveTab('history')}\r\n            className={`flex-1 py-2 px-4 text-sm font-medium rounded-md ${\r\n              activeTab === 'history'\r\n                ? 'bg-blue-500 text-white'\r\n                : 'text-gray-500 hover:text-gray-700'\r\n            }`}\r\n          >\r\n            L·ªãch s·ª≠ giao d·ªãch\r\n          </button>\r\n        </nav>\r\n      </div>\r\n\r\n      {/* Content */}\r\n      {activeTab === 'market' ? (\r\n        <>\r\n          {/* Demo notice */}\r\n          {items.some(item => item.id.startsWith('demo')) && (\r\n            <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4\">\r\n              <h3 className=\"text-yellow-800 font-semibold\">Ch·∫ø ƒë·ªô Demo</h3>\r\n              <p className=\"text-yellow-700 text-sm\">\r\n                C√°c s·∫£n ph·∫©m d∆∞·ªõi ƒë√¢y l√† demo ƒë·ªÉ test ch·ª©c nƒÉng mua b√°n. \r\n                B·∫°n c√≥ th·ªÉ mua b·∫•t k·ª≥ s·∫£n ph·∫©m n√†o (k·ªÉ c·∫£ c·ªßa b·∫°n) ƒë·ªÉ test.\r\n              </p>\r\n            </div>\r\n          )}\r\n\r\n          {/* Gas fee explanation */}\r\n          <div className=\"bg-green-50 border border-green-200 rounded-lg p-4 mb-4\">\r\n            <h3 className=\"text-green-800 font-semibold\">T·∫°i sao c·∫ßn thanh to√°n khi th√™m s·∫£n ph·∫©m?</h3>\r\n            <div className=\"text-green-700 text-sm mt-2 space-y-2\">\r\n              <p>\r\n                <strong>Gas fee:</strong> M·ªçi thao t√°c ghi l√™n blockchain ƒë·ªÅu c·∫ßn ph√≠ gas (~0.001 IOTA) ƒë·ªÉ tr·∫£ cho validators.\r\n              </p>\r\n              <p>\r\n                <strong>Kh√°c bi·ªát:</strong> \r\n                ‚Ä¢ Th√™m s·∫£n ph·∫©m = Ch·ªâ tr·∫£ gas fee nh·ªè\r\n                ‚Ä¢ Mua s·∫£n ph·∫©m = Tr·∫£ ti·ªÅn s·∫£n ph·∫©m + gas fee\r\n              </p>\r\n              <p>\r\n                <strong>L·ª£i √≠ch:</strong> D·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u tr·ªØ vƒ©nh vi·ªÖn tr√™n blockchain, kh√¥ng th·ªÉ b·ªã thay ƒë·ªïi.\r\n              </p>\r\n            </div>\r\n          </div>\r\n          <AddItemForm \r\n            onAddItem={handleAddItem} \r\n            isLoading={isLoading || contractLoading} \r\n          />\r\n          <ItemList \r\n            items={items} \r\n            onBuyItem={handleBuyItem} \r\n            currentUser={account?.address || ''}\r\n            isLoading={isLoading || contractLoading}\r\n          />\r\n        </>\r\n      ) : (\r\n        <TransactionHistory \r\n          transactions={transactions} \r\n          currentUser={account?.address || ''}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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"}}]
}